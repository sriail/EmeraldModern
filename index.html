<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/emerald.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Emerald ‚≠ê</title>
    <meta
      name="description"
      content="The Emerald service, your one stop solution for all you're nefarious needs"
    />
    <meta name="og:image" content="/emerald.png" />

    <link rel="prefetch" href="/scram/scramjet.worker.js" />
    <link rel="prefetch" href="/scram/scramjet.shared.js" />
  </head>
  <body>
    <div id="root"></div>
    <input type="password" name="" id="" style="height: 0px; width: 0px; position: absolute; top: -1000px; left: -1000px" />
    <script src="/scram/scramjet.controller.js"></script>
   <script>
  const scramjet = new ScramjetController({
    prefix: "/~/scramjet/",
    files: {
      wasm: "/scram/scramjet.wasm.wasm",
      worker: "/scram/scramjet.worker.js",
      client: "/scram/scramjet.client.js",
      shared: "/scram/scramjet.shared.js",
      sync: "/scram/scramjet.sync.js",
    },
  });
  window.sj = scramjet;
</script>

<script>
  // Global popup interceptor for Scramjet
  (function() {
    const originalOpen = window.open;
    
    window.open = function(url, target, features) {
      console.log('[Emerald Global] window.open called:', url, target, features);
      
      // Check if this is a proxy URL trying to open in a new window
      if (url && (url.includes('/~/scramjet/') || url.includes('/~/uv/'))) {
        console.log('[Emerald Global] Proxy popup detected, sending to React');
        
        // Send message to React app
        window.postMessage({
          type: 'PROXY_POPUP',
          url: url,
          target: target,
          timestamp: Date.now()
        }, '*');
        
        // Block the popup
        return null;
      }
      
      // Allow other popups
      return originalOpen.call(this, url, target, features);
    };
    
    console.log('[Emerald Global] Popup interceptor installed');
  })();
</script>
    </script>
    <script src="/uv/uv.bundle.js"></script>
    <script src="/uv/uv.config.js"></script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
